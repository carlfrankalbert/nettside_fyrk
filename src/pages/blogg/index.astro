---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => {
  return !data.draft;
})).sort((a, b) => {
  return b.data.date.getTime() - a.data.date.getTime();
});
---

<BaseLayout 
  title="Blogg"
  description="Les våre artikler om produktledelse, kvalitet, smidig utvikling og mer."
>
  <section class="py-24 bg-white" aria-labelledby="blog-heading">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <h1 id="blog-heading" class="text-h1 mb-4">Blogg</h1>
        <p class="text-lg text-neutral-500 mb-12">
          Her deler vi innsikt, erfaringer og tanker om produktledelse, kvalitet og smidig utvikling.
        </p>

        {posts.length > 0 ? (
          <div class="space-y-8">
            {posts.map((post) => (
              <article class="card">
                <h2 class="text-h3 mb-3">
                  <a 
                    href={`/blogg/${post.slug}`}
                    class="text-brand-navy hover:text-brand-cyan-darker transition-colors duration-fast"
                  >
                    {post.data.title}
                  </a>
                </h2>
                <p class="text-neutral-500 text-sm mb-4">
                  {post.data.date.toLocaleDateString('no-NO', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                  })}
                </p>
                <p class="text-neutral-700 leading-relaxed">
                  {post.data.description}
                </p>
                <a 
                  href={`/blogg/${post.slug}`}
                  class="inline-block mt-4 text-brand-cyan-darker hover:text-brand-cyan font-medium"
                  aria-label={`Les mer om ${post.data.title}`}
                >
                  Les mer <span aria-hidden="true">→</span>
                </a>
              </article>
            ))}
          </div>
        ) : (
          <div class="text-center py-12">
            <p class="text-neutral-500 text-lg">
              Ingen innlegg ennå. Sjekk tilbake snart!
            </p>
          </div>
        )}
      </div>
    </div>
  </section>
</BaseLayout>

