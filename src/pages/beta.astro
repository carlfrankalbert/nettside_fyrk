---
export const prerender = false;

import {
  BETA_COOKIE_NAME,
  BETA_COOKIE_MAX_AGE,
  hasBetaAccess,
} from '../utils/feature-toggles';

// Get the secret token from environment
// Cloudflare runtime env vars may not be on import.meta.env
const runtime = (Astro.locals as Record<string, unknown>).runtime as { env?: Record<string, string> } | undefined;
const cloudflareEnv = runtime?.env;
const expectedToken = import.meta.env.BETA_TOKEN ?? cloudflareEnv?.BETA_TOKEN;